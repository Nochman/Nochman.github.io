<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dataset & Distributions (PostgreSQL)</title>
  <style>
body {
font-family: Arial, sans-serif;
background: #f9f9f9;
color: #222;
margin: 40px;
}
h1 {
font-size: 1.6em;
margin-bottom: 0.2em;
}
h2 {
font-size: 1.2em;
margin-top: 1.5em;
border-bottom: 1px solid #ccc;
padding-bottom: 0.2em;
}
p {
margin: 0.3em 0 1em;
}
code {
background: #eee;
padding: 2px 4px;
border-radius: 3px;
font-size: 0.95em;
}
img {
display: block;
margin: 10px 0;
border: 1px solid #ccc;
border-radius: 4px;
width: 400px;
height: auto;
}
figcaption {
font-size: 0.9em;
color: #555;
margin-bottom: 1em;
}
</style>
</head>
<body>
<h1>Dataset Creation & Distributions</h1>
<p>A dataset is a structured collection of related data, typically organized in rows (observations) and columns (variables or features). 
  It represents the raw information gathered for analysis or modeling. A distribution, 
  on the other hand, describes how the values of a variable in that dataset are spread or occur, 
  showing the frequency or probability of different outcomes. When analyzing one variable at a time, 
  it’s called a univariate distribution (e.g., the distribution of heights in a group). When analyzing two or more variables together, 
  it’s called a multivariate distribution (e.g., the joint distribution of height and weight).</p>


<h2>1) Dataset (PostgreSQL)</h2>
<p>Source: PostgreSQL table <code>people</code> with columns <code>height_cm</code>, <code>weight_kg</code>, and <code>eye_color</code>.</p>
<figure>
<img src="../assets/week02/table1.PNG" alt="Dataset table screenshot" />
</figure>


<h2>2) Univariate Distribution</h2>
<p>Computed with <code>SELECT eye_color, COUNT(*) FROM people GROUP BY eye_color;</code></p>
<figure>
<img src="../assets/week02/univ.PNG" alt="Univariate distribution screenshot" />
</figure>


<h2>3) Bivariate Distribution</h2>
<p>Computed with <code>SELECT height_bin, eye_color, COUNT(*) FROM people GROUP BY height_bin, eye_color;</code></p>
<figure>
<img src="../assets/week02/biv.PNG" alt="Bivariate distribution screenshot" />
</figure>

<h2>4) Text Analysis: Letter Distribution & Caesar Cipher</h2>
<p>Enter any text below. You can compute its letter distribution, encrypt with a Caesar cipher, and then auto-decode the cipher using language frequency analysis (no shift given).</p>


<div>
<label for="inputText"><strong>Input text</strong></label>
<textarea id="inputText" placeholder="Paste or type text here..."></textarea>
<button id="btnDist">Compute distribution</button>
</div>


<div id="distOutput" style="margin-top:10px;"></div>


<div style="margin-top:16px;">
<label for="shiftInput"><strong>Shift</strong> (e.g., 3)</label>
<input id="shiftInput" type="number" value="3" min="-26" max="26" style="width:80px;" />
<button id="btnEncrypt">Encrypt (Caesar)</button>
<textarea id="encryptedText" placeholder="Encrypted text appears here..."></textarea>
</div>


<div style="margin-top:16px;">
<button id="btnAutoDecode">Auto-decode (no shift given)</button>
<textarea id="decodedText" placeholder="Decoded text appears here..."></textarea>
<div id="decodeReport"></div>
</div>


<style>
/* minimal, additive styles */
textarea { width: 100%; height: 120px; }
table.simple { border-collapse: collapse; font-size: 0.95em; }
table.simple th, table.simple td { border: 1px solid #ccc; padding: 4px 6px; text-align: right; }
table.simple th:first-child, table.simple td:first-child { text-align: left; }
.muted { color: #555; font-size: 0.9em; }
</style>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const ENG_FREQ = {
    A:8.167, B:1.492, C:2.782, D:4.253, E:12.702, F:2.228, G:2.015,
    H:6.094, I:6.966, J:0.153, K:0.772, L:4.025, M:2.406, N:6.749,
    O:7.507, P:1.929, Q:0.095, R:5.987, S:6.327, T:9.056, U:2.758,
    V:0.978, W:2.360, X:0.150, Y:1.974, Z:0.074
  };

  const A_CODE = 'A'.charCodeAt(0);

  function cleanUpper(text){ return text.toUpperCase(); }

  function letterCounts(text){
    const counts = Array(26).fill(0);
    let total = 0;
    for (const ch of cleanUpper(text)){
      const code = ch.charCodeAt(0);
      if (code >= A_CODE && code < A_CODE + 26){
        counts[code - A_CODE]++; total++;
      }
    }
    return { counts, total };
  }

  function renderDistribution(counts, total){
    let html = '<table class="simple"><thead><tr><th>Letter</th><th>Count</th><th>%</th></tr></thead><tbody>';
    for (let i = 0; i < 26; i++){
      const L = String.fromCharCode(A_CODE + i);
      const c = counts[i];
      const p = total ? (c * 100 / total) : 0;
      html += `<tr><td>${L}</td><td>${c}</td><td>${p.toFixed(2)}</td></tr>`;
    }
    html += `<tr><th>Total</th><th>${total}</th><th>100.00</th></tr></tbody></table>`;
    return html;
  }

  function caesarShift(text, shift){
    const s = ((shift % 26) + 26) % 26;
    let out = '';
    for (const ch of text){
      if (/[A-Z]/.test(ch)){
        const code = ch.charCodeAt(0) - 65;
        out += String.fromCharCode(65 + ((code + s) % 26));
      } else if (/[a-z]/.test(ch)){
        const code = ch.charCodeAt(0) - 97;
        out += String.fromCharCode(97 + ((code + s) % 26));
      } else {
        out += ch;
      }
    }
    return out;
  }

  function chiSquaredScore(text){
    const { counts, total } = letterCounts(text);
    if (!total) return Infinity;
    let chi = 0;
    for (let i = 0; i < 26; i++){
      const L = String.fromCharCode(A_CODE + i);
      const observed = counts[i];
      const expected = total * (ENG_FREQ[L] / 100);
      if (expected > 0){
        chi += Math.pow(observed - expected, 2) / expected;
      }
    }
    return chi;
  }

  function autoDecode(cipher){
    let best = { shift: 0, score: Infinity, plaintext: cipher };
    for (let s = 0; s < 26; s++){
      const attempt = caesarShift(cipher, -s);
      const score = chiSquaredScore(attempt);
      if (score < best.score){
        best = { shift: s, score, plaintext: attempt };
      }
    }
    return best;
  }

  // ---- Event listeners ----
  const $ = (sel) => document.querySelector(sel);

  $('#btnDist').addEventListener('click', () => {
    const text = $('#inputText').value || '';
    const { counts, total } = letterCounts(text);
    $('#distOutput').innerHTML = renderDistribution(counts, total);
  });

  $('#btnEncrypt').addEventListener('click', () => {
    const text = $('#inputText').value || '';
    const shift = parseInt($('#shiftInput').value || '0', 10);
    $('#encryptedText').value = caesarShift(text, shift);
  });

  $('#btnAutoDecode').addEventListener('click', () => {
    const cipher = $('#encryptedText').value || '';
    const result = autoDecode(cipher);
    $('#decodedText').value = result.plaintext;
  });
});
</script>
 
</body>
</html>

