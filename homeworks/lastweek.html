<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Euler–Maruyama: Wiener Process</title>
<style>
  html,body{margin:0;padding:0;background:#fff;color:#111;font:14px/1.45 system-ui}
  .wrap{max-width:900px;margin:24px auto;padding:0 16px}
  h1{font-size:18px;margin:8px 0 16px}
  .controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:8px;margin-bottom:12px}
  .controls label{display:flex;flex-direction:column;gap:4px;border:1px solid #ddd;border-radius:10px;padding:8px}
  .controls input{padding:6px 8px;border:1px solid #ddd;border-radius:8px}
  button{padding:10px 14px;border-radius:10px;border:1px solid #ddd;background:#f8fafc;cursor:pointer}
  button:hover{background:#eef2ff}
  .card{border:1px solid #ddd;border-radius:12px;padding:12px;margin-bottom:14px}
  .meta{color:#666;font-size:12px;margin-bottom:4px}
  canvas{width:100%;height:360px;background:#fff;border-radius:8px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Euler–Maruyama Simulator Wiener Process</h1>
  <div class="controls">
    <label>Drift (μ)
      <input id="mu" type="number" step="0.01" value="0" />
    </label>
    <label>Volatility (σ)
      <input id="sigma" type="number" step="0.01" value="1" />
    </label>
    <label>Horizon T
      <input id="T" type="number" step="0.1" value="1" />
    </label>
    <label>Time steps (N)
      <input id="N" type="number" min="1" value="500" />
    </label>
    <label>Plot sample paths (K)
      <input id="K" type="number" min="1" value="8" />
    </label>
    <button id="run">Run Simulation</button>
  </div>

  <div class="card">
    <div class="meta">Sample paths X(t)</div>
    <canvas id="paths"></canvas>
  </div>
</div>

<script>
// Normal RNG (Box–Muller)
function normal01(){
  let u=0,v=0; while(u===0) u=Math.random(); while(v===0) v=Math.random();
  return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);
}

function getCtx(id){
  const c=document.getElementById(id);
  const r=window.devicePixelRatio||1;
  const w=c.clientWidth, h=c.clientHeight;
  if(c.width!==w*r||c.height!==h*r){c.width=w*r; c.height=h*r;}
  const ctx=c.getContext('2d'); ctx.setTransform(r,0,0,r,0,0); ctx.clearRect(0,0,w,h);
  return {ctx,w,h};
}

function drawAxes(ctx,w,h,p=28){
  ctx.strokeStyle="#ccc";
  ctx.beginPath(); ctx.moveTo(p,h-p); ctx.lineTo(w-p,h-p);
  ctx.moveTo(p,p); ctx.lineTo(p,h-p); ctx.stroke();
  return {x0:p,y0:h-p,x1:w-p,y1:p};
}
function mapLin(x,a,b,A,B){return A+(x-a)*(B-A)/(b-a);} 

function runSim(){
  const mu=Number(document.getElementById('mu').value);
  const sigma=Number(document.getElementById('sigma').value);
  const T=Number(document.getElementById('T').value);
  const N=Number(document.getElementById('N').value);
  const K=Number(document.getElementById('K').value);

  const dt=T/N, sdt=Math.sqrt(dt);

  const paths=[];
  for(let j=0;j<K;j++){
    const path=new Float64Array(N+1);
    let x=0; path[0]=0;
    for(let k=0;k<N;k++){
      x = x + mu*dt + sigma*sdt*normal01();
      path[k+1]=x;
    }
    paths.push(path);
  }

  const {ctx,w,h}=getCtx('paths');
  const ax=drawAxes(ctx,w,h);
  let ymin=0,ymax=0;
  for(const p of paths){for(const y of p){if(y<ymin) ymin=y; if(y>ymax) ymax=y;}}
  if(ymin===ymax){ymin-=1;ymax+=1;}

  ctx.strokeStyle="#444";
  for(const p of paths){
    ctx.beginPath();
    for(let i=0;i<p.length;i++){
      const x = mapLin(i/N, 0,1, ax.x0, ax.x1);
      const y = mapLin(p[i], ymin,ymax, ax.y0, ax.y1);
      if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
    }
    ctx.stroke();
  }
}

document.getElementById('run').onclick = runSim;
runSim();
</script>
</body>
</html>

